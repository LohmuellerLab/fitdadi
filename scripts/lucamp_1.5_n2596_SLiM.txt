// set up the simulation
initialize(){
    initializeMutationRate(1.5e-8);
    
    // m1 mutation type: gamma
    // note: some rescaling is done since we use 1,1+2sh,1+s and SLiM uses 1,1+hs,1+s
    initializeMutationType("m1", 0.5, "g", -0.00264921383393, 0.338);
    
    // m2 mutation type: neutral
    initializeMutationType("m2", 0.5, "f", 0.0);
    
    // g1 genomic element type: uses mixture of gamma and neutral
    initializeGenomicElementType("g1", c(m1,n2), c(0.836,0.164));

    // uniform chromosome of length 1 Mb with uniform recombination
    initalizeGenomicElement(g1, 0, 999999);
    initalizeRecombinationRate(1e-8);
}

// this is the population demography
1 { sim.addSubpop("p1", 11728); }
1 { p1.setSubpopulationSize(1054); }
236 { p1.setSubpopulationSize(12329); }
1949 { p1.setSubpopulationSize(12484); }
1950 { p1.setSubpopulationSize(12641); }
1951 { p1.setSubpopulationSize(12799); }
1952 { p1.setSubpopulationSize(12960); }
1953 { p1.setSubpopulationSize(13123); }
1954 { p1.setSubpopulationSize(13288); }
1955 { p1.setSubpopulationSize(13455); }
1956 { p1.setSubpopulationSize(13624); }
1957 { p1.setSubpopulationSize(13796); }
1958 { p1.setSubpopulationSize(13969); }
1959 { p1.setSubpopulationSize(14145); }
1960 { p1.setSubpopulationSize(14322); }
1961 { p1.setSubpopulationSize(14502); }
1962 { p1.setSubpopulationSize(14685); }
1963 { p1.setSubpopulationSize(14869); }
1964 { p1.setSubpopulationSize(15056); }
1965 { p1.setSubpopulationSize(15245); }
1966 { p1.setSubpopulationSize(15437); }
1967 { p1.setSubpopulationSize(15631); }
1968 { p1.setSubpopulationSize(15827); }
1969 { p1.setSubpopulationSize(16026); }
1970 { p1.setSubpopulationSize(16228); }
1971 { p1.setSubpopulationSize(16432); }
1972 { p1.setSubpopulationSize(16638); }
1973 { p1.setSubpopulationSize(16847); }
1974 { p1.setSubpopulationSize(17059); }
1975 { p1.setSubpopulationSize(17274); }
1976 { p1.setSubpopulationSize(17491); }
1977 { p1.setSubpopulationSize(17710); }
1978 { p1.setSubpopulationSize(17933); }
1979 { p1.setSubpopulationSize(18158); }
1980 { p1.setSubpopulationSize(18387); }
1981 { p1.setSubpopulationSize(18618); }
1982 { p1.setSubpopulationSize(18852); }
1983 { p1.setSubpopulationSize(19089); }
1984 { p1.setSubpopulationSize(19329); }
1985 { p1.setSubpopulationSize(19572); }
1986 { p1.setSubpopulationSize(19818); }
1987 { p1.setSubpopulationSize(20067); }
1988 { p1.setSubpopulationSize(20319); }
1989 { p1.setSubpopulationSize(20574); }
1990 { p1.setSubpopulationSize(20833); }
1991 { p1.setSubpopulationSize(21095); }
1992 { p1.setSubpopulationSize(21360); }
1993 { p1.setSubpopulationSize(21628); }
1994 { p1.setSubpopulationSize(21900); }
1995 { p1.setSubpopulationSize(22175); }
1996 { p1.setSubpopulationSize(22454); }
1997 { p1.setSubpopulationSize(22736); }
1998 { p1.setSubpopulationSize(23022); }
1999 { p1.setSubpopulationSize(23311); }
2000 { p1.setSubpopulationSize(23604); }
2001 { p1.setSubpopulationSize(23901); }
2002 { p1.setSubpopulationSize(24202); }
2003 { p1.setSubpopulationSize(24506); }
2004 { p1.setSubpopulationSize(24814); }
2005 { p1.setSubpopulationSize(25126); }
2006 { p1.setSubpopulationSize(25441); }
2007 { p1.setSubpopulationSize(25761); }
2008 { p1.setSubpopulationSize(26085); }
2009 { p1.setSubpopulationSize(26413); }
2010 { p1.setSubpopulationSize(26745); }
2011 { p1.setSubpopulationSize(27081); }
2012 { p1.setSubpopulationSize(27421); }
2013 { p1.setSubpopulationSize(27766); }
2014 { p1.setSubpopulationSize(28115); }
2015 { p1.setSubpopulationSize(28468); }
2016 { p1.setSubpopulationSize(28826); }
2017 { p1.setSubpopulationSize(29188); }
2018 { p1.setSubpopulationSize(29555); }
2019 { p1.setSubpopulationSize(29927); }
2020 { p1.setSubpopulationSize(30303); }
2021 { p1.setSubpopulationSize(30684); }
2022 { p1.setSubpopulationSize(31069); }
2023 { p1.setSubpopulationSize(31460); }
2024 { p1.setSubpopulationSize(31855); }
2025 { p1.setSubpopulationSize(32256); }
2026 { p1.setSubpopulationSize(32661); }
2027 { p1.setSubpopulationSize(33072); }
2028 { p1.setSubpopulationSize(33487); }
2029 { p1.setSubpopulationSize(33908); }
2030 { p1.setSubpopulationSize(34334); }
2031 { p1.setSubpopulationSize(34766); }
2032 { p1.setSubpopulationSize(35203); }
2033 { p1.setSubpopulationSize(35645); }
2034 { p1.setSubpopulationSize(36093); }
2035 { p1.setSubpopulationSize(36547); }
2036 { p1.setSubpopulationSize(37006); }
2037 { p1.setSubpopulationSize(37471); }
2038 { p1.setSubpopulationSize(37942); }
2039 { p1.setSubpopulationSize(38419); }
2040 { p1.setSubpopulationSize(38902); }
2041 { p1.setSubpopulationSize(39391); }
2042 { p1.setSubpopulationSize(39886); }
2043 { p1.setSubpopulationSize(40388); }
2044 { p1.setSubpopulationSize(40895); }
2045 { p1.setSubpopulationSize(41409); }
2046 { p1.setSubpopulationSize(41930); }
2047 { p1.setSubpopulationSize(42457); }
2048 { p1.setSubpopulationSize(42990); }
2049 { p1.setSubpopulationSize(43531); }
2050 { p1.setSubpopulationSize(44078); }
2051 { p1.setSubpopulationSize(44632); }
2052 { p1.setSubpopulationSize(45193); }
2053 { p1.setSubpopulationSize(45761); }
2054 { p1.setSubpopulationSize(46336); }
2055 { p1.setSubpopulationSize(46918); }
2056 { p1.setSubpopulationSize(47508); }
2057 { p1.setSubpopulationSize(48105); }
2058 { p1.setSubpopulationSize(48710); }
2059 { p1.setSubpopulationSize(49322); }
2060 { p1.setSubpopulationSize(49942); }
2061 { p1.setSubpopulationSize(50570); }
2062 { p1.setSubpopulationSize(51205); }
2063 { p1.setSubpopulationSize(51849); }
2064 { p1.setSubpopulationSize(52500); }
2065 { p1.setSubpopulationSize(53160); }
2066 { p1.setSubpopulationSize(53828); }
2067 { p1.setSubpopulationSize(54505); }
2068 { p1.setSubpopulationSize(55190); }
2069 { p1.setSubpopulationSize(55884); }
2070 { p1.setSubpopulationSize(56586); }
2071 { p1.setSubpopulationSize(57297); }
2072 { p1.setSubpopulationSize(58018); }
2073 { p1.setSubpopulationSize(58747); }
2074 { p1.setSubpopulationSize(59485); }
2075 { p1.setSubpopulationSize(60233); }
2076 { p1.setSubpopulationSize(60990); }
2077 { p1.setSubpopulationSize(61756); }
2078 { p1.setSubpopulationSize(62533); }
2079 { p1.setSubpopulationSize(63319); }
2080 { p1.setSubpopulationSize(64114); }
2081 { p1.setSubpopulationSize(64920); }
2082 { p1.setSubpopulationSize(65736); }
2083 { p1.setSubpopulationSize(66562); }
2084 { p1.setSubpopulationSize(67399); }
2085 { p1.setSubpopulationSize(68246); }
2086 { p1.setSubpopulationSize(69104); }
2087 { p1.setSubpopulationSize(69972); }
2088 { p1.setSubpopulationSize(70852); }
2089 { p1.setSubpopulationSize(71742); }
2090 { p1.setSubpopulationSize(72644); }
2091 { p1.setSubpopulationSize(73557); }
2092 { p1.setSubpopulationSize(74482); }
2093 { p1.setSubpopulationSize(75418); }
2094 { p1.setSubpopulationSize(76366); }
2095 { p1.setSubpopulationSize(77326); }
2096 { p1.setSubpopulationSize(78297); }
2097 { p1.setSubpopulationSize(79282); }
2098 { p1.setSubpopulationSize(80278); }
2099 { p1.setSubpopulationSize(81287); }
2100 { p1.setSubpopulationSize(82309); }
2101 { p1.setSubpopulationSize(83343); }
2102 { p1.setSubpopulationSize(84391); }
2103 { p1.setSubpopulationSize(85451); }
2104 { p1.setSubpopulationSize(86525); }
2105 { p1.setSubpopulationSize(87613); }
2106 { p1.setSubpopulationSize(88714); }
2107 { p1.setSubpopulationSize(89829); }
2108 { p1.setSubpopulationSize(90958); }
2109 { p1.setSubpopulationSize(92101); }
2110 { p1.setSubpopulationSize(93259); }
2111 { p1.setSubpopulationSize(94431); }
2112 { p1.setSubpopulationSize(95618); }
2113 { p1.setSubpopulationSize(96820); }
2114 { p1.setSubpopulationSize(98037); }
2115 { p1.setSubpopulationSize(99269); }
2116 { p1.setSubpopulationSize(100517); }
2117 { p1.setSubpopulationSize(101780); }
2118 { p1.setSubpopulationSize(103059); }
2119 { p1.setSubpopulationSize(104355); }
2120 { p1.setSubpopulationSize(105666); }
2121 { p1.setSubpopulationSize(106994); }
2122 { p1.setSubpopulationSize(108339); }
2123 { p1.setSubpopulationSize(109701); }
2124 { p1.setSubpopulationSize(111080); }
2125 { p1.setSubpopulationSize(112476); }
2126 { p1.setSubpopulationSize(113889); }
2127 { p1.setSubpopulationSize(115321); }
2128 { p1.setSubpopulationSize(116770); }
2129 { p1.setSubpopulationSize(118238); }
2130 { p1.setSubpopulationSize(119724); }
2131 { p1.setSubpopulationSize(121229); }
2132 { p1.setSubpopulationSize(122753); }
2133 { p1.setSubpopulationSize(124295); }
2134 { p1.setSubpopulationSize(125858); }
2135 { p1.setSubpopulationSize(127439); }
2136 { p1.setSubpopulationSize(129041); }
2137 { p1.setSubpopulationSize(130663); }
2138 { p1.setSubpopulationSize(132305); }
2139 { p1.setSubpopulationSize(133968); }
2140 { p1.setSubpopulationSize(135652); }
2141 { p1.setSubpopulationSize(137357); }
2142 { p1.setSubpopulationSize(139083); }
2143 { p1.setSubpopulationSize(140832); }
2144 { p1.setSubpopulationSize(142602); }
2145 { p1.setSubpopulationSize(144394); }
2146 { p1.setSubpopulationSize(146209); }
2147 { p1.setSubpopulationSize(148047); }
2148 { p1.setSubpopulationSize(149907); }
2149 { p1.setSubpopulationSize(151791); }
2150 { p1.setSubpopulationSize(153699); }
2151 { p1.setSubpopulationSize(155631); }
2152 { p1.setSubpopulationSize(157587); }
2153 { p1.setSubpopulationSize(159568); }
2154 { p1.setSubpopulationSize(161573); }
2155 { p1.setSubpopulationSize(163604); }
2156 { p1.setSubpopulationSize(165660); }
2157 { p1.setSubpopulationSize(167743); }
2158 { p1.setSubpopulationSize(169851); }
2159 { p1.setSubpopulationSize(171986); }
2160 { p1.setSubpopulationSize(174147); }
2161 { p1.setSubpopulationSize(176336); }
2162 { p1.setSubpopulationSize(178553); }
2163 { p1.setSubpopulationSize(180797); }
2164 { p1.setSubpopulationSize(183069); }
2165 { p1.setSubpopulationSize(185370); }
2166 { p1.setSubpopulationSize(187700); }
2167 { p1.setSubpopulationSize(190059); }
2168 { p1.setSubpopulationSize(192448); }
2169 { p1.setSubpopulationSize(194867); }
2170 { p1.setSubpopulationSize(197316); }
2171 { p1.setSubpopulationSize(199796); }
2172 { p1.setSubpopulationSize(202307); }
2173 { p1.setSubpopulationSize(204850); }
2174 { p1.setSubpopulationSize(207425); }
2175 { p1.setSubpopulationSize(210032); }
2176 { p1.setSubpopulationSize(212671); }
2177 { p1.setSubpopulationSize(215344); }
2178 { p1.setSubpopulationSize(218051); }
2179 { p1.setSubpopulationSize(220792); }
2180 { p1.setSubpopulationSize(223567); }
2181 { p1.setSubpopulationSize(226377); }
2182 { p1.setSubpopulationSize(229222); }
2183 { p1.setSubpopulationSize(232103); }
2184 { p1.setSubpopulationSize(235020); }
2185 { p1.setSubpopulationSize(237974); }
2186 { p1.setSubpopulationSize(240965); }
2187 { p1.setSubpopulationSize(243994); }
2188 { p1.setSubpopulationSize(247061); }
2189 { p1.setSubpopulationSize(250166); }
2190 { p1.setSubpopulationSize(253310); }
2191 { p1.setSubpopulationSize(256494); }
2192 { p1.setSubpopulationSize(259718); }
2193 { p1.setSubpopulationSize(262982); }
2194 { p1.setSubpopulationSize(266287); }
2195 { p1.setSubpopulationSize(269634); }
2196 { p1.setSubpopulationSize(273023); }
2197 { p1.setSubpopulationSize(276455); }
2198 { p1.setSubpopulationSize(279930); }
2199 { p1.setSubpopulationSize(283448); }
2200 { p1.setSubpopulationSize(287010); }
2201 { p1.setSubpopulationSize(290618); }
2202 { p1.setSubpopulationSize(294271); }
2203 { p1.setSubpopulationSize(297969); }
2204 { p1.setSubpopulationSize(301714); }
2205 { p1.setSubpopulationSize(305506); }
2206 { p1.setSubpopulationSize(309346); }
2207 { p1.setSubpopulationSize(313234); }
2208 { p1.setSubpopulationSize(317171); }
2209 { p1.setSubpopulationSize(321158); }
2210 { p1.setSubpopulationSize(325194); }
2211 { p1.setSubpopulationSize(329282); }
2212 { p1.setSubpopulationSize(333420); }
2213 { p1.setSubpopulationSize(337611); }
2214 { p1.setSubpopulationSize(341854); }
2215 { p1.setSubpopulationSize(346151); }
2216 { p1.setSubpopulationSize(350502); }
2217 { p1.setSubpopulationSize(354907); }
2218 { p1.setSubpopulationSize(359368); }
2219 { p1.setSubpopulationSize(363885); }
2220 { p1.setSubpopulationSize(368458); }

//output samples at the end
2222 late() { p1.outputSample(2596); }
